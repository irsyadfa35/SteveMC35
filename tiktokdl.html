<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#0a1a2f">
<title>Downloader TikTok Otomatis</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

body {
  font-family: 'Poppins', sans-serif;
  background: url('https://qu.ax/ZOvQX.jpg') no-repeat center center fixed;
  background-size: cover;
  color: #fff;
  padding: 20px;
  margin:0;
  position: relative;
}

body::before {
  content: "";
  position: fixed;
  top:0; left:0; right:0; bottom:0;
  backdrop-filter: blur(6px);
  background: rgba(0,0,0,0.5);
  z-index: -1;
}

h2 { text-align: center; margin-bottom: 20px; }

input {
  padding: 12px 15px;
  font-size: 16px;
  width: calc(100% - 140px);
  max-width: 600px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.3);
  background: rgba(0, 120, 255, 0.2);
  color: #fff;
  backdrop-filter: blur(6px);
  margin-right: 10px;
}

input::placeholder { color: #ccc; }

button {
  padding: 12px 20px;
  font-size: 16px;
  border-radius: 10px;
  border: 1px solid rgba(0,120,255,0.6);
  cursor: pointer;
  color: #fff;
  background: rgba(0, 120, 255, 0.3);
  backdrop-filter: blur(6px);
  transition: all 0.3s ease;
  margin: 5px 5px 5px 0;
}

button:hover {
  background: rgba(0, 120, 255, 0.5);
  border-color: rgba(0,120,255,0.9);
}

#result { margin-top: 30px; position: relative; }

.audio-controls {
  position: sticky;
  top: 0;
  background: rgba(0,0,0,0.5);
  padding: 10px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
  z-index: 10;
}

.carousel-container { position: relative; overflow: hidden; width: 100%; max-width: 100%; }

.carousel {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

.carousel-item {
  flex-shrink: 0;
  width: 100%;
  scroll-snap-align: center;
  text-align: center;
}

.carousel-item img {
  width: 100%;
  height: 80vh;
  object-fit: contain;
  border-radius: 10px;
}

.counter {
  position: absolute;
  top: 10px;
  right: 20px;
  background: rgba(0,0,0,0.5);
  padding: 5px 10px;
  border-radius: 20px;
  font-weight: bold;
}

video { max-width: 100%; border-radius: 10px; display: block; margin-bottom: 10px; }

.download-buttons a { text-decoration: none; }

.download-buttons button { margin-top: 10px; }

#homeBtn button {
  padding: 8px 12px;
  font-size: 14px;
}

#copyright {
  position: fixed;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 12px;
  color: #ccc;
}
</style>
</head>
<body>
<a href="index.html" id="homeBtn"><button>Home</button></a>

<h2>Downloader TikTok Otomatis</h2>
<div style="display:flex; flex-wrap:wrap; justify-content:center;">
  <input type="text" id="tiktokLink" placeholder="Paste link TikTok di sini">
  <button onclick="prosesTikTok()">Proses</button>
  <button onclick="document.getElementById('tiktokLink').value=''">Clear</button>
</div>

<div id="result"></div>
<div id="copyright">Â©2025 SteveMC Developer</div>

<script>
async function prosesTikTok() {
  const link = document.getElementById('tiktokLink').value.trim();
  if(!link) return alert("Masukkan link TikTok dulu!");

  const resultDiv = document.getElementById('result');
  resultDiv.innerHTML = "Sedang memproses...";

  try {
    // API TikTok foto slide
    const apiFoto = `https://endernet.web.id/bagian1/ssstik?link=${encodeURIComponent(link)}`;
    const resFoto = await fetch(apiFoto);
    const jsonFoto = await resFoto.json();

    // API TikTok video
    const apiVideo = `https://endernet.web.id/bagian1/endertikdownload?link=${encodeURIComponent(link)}`;
    const resVideo = await fetch(apiVideo);
    const jsonVideo = await resVideo.json();

    // Kalau slide/foto
    if(jsonFoto.status === "success" && jsonFoto.result.images && jsonFoto.result.images.length > 0) {
      const images = jsonFoto.result.images;
      let audioUrl = null;
      if(jsonVideo.status === "berhasil" && jsonVideo.data.mp3) {
        audioUrl = jsonVideo.data.mp3.url;
      }

      let html = '';

      if(audioUrl) {
        html += `<div class="audio-controls">
                   <a href="${audioUrl}" download="audioTikTok.mp3"><button>Unduh Audio</button></a>
                   <audio controls src="${audioUrl}"></audio>
                 </div>`;
      }

      html += `<h3>Foto TikTok dari @${jsonFoto.result.author.nickname}</h3>
               <div class="carousel-container">
                 <div class="carousel">`;

      images.forEach((img, idx) => {
        html += `<div class="carousel-item">
                   <img src="${img}" alt="Foto TikTok">
                   <div class="download-buttons">
                     <a href="${img}" download="fotoTikTok_${idx+1}.jpg"><button>Unduh Foto</button></a>
                   </div>
                 </div>`;
      });

      html += `</div>
               <div class="counter">1/${images.length}</div>
               </div>`;

      resultDiv.innerHTML = html;

      const carousel = resultDiv.querySelector('.carousel');
      const counter = resultDiv.querySelector('.counter');

      carousel.addEventListener('scroll', () => {
        const index = Math.round(carousel.scrollLeft / carousel.clientWidth) + 1;
        counter.textContent = `${index}/${images.length}`;
      });

      return;
    }

    // Kalau video
    if(jsonVideo.status === "berhasil" && jsonVideo.data.video) {
      const videoData = jsonVideo.data.video;
      const mp3Data = jsonVideo.data.mp3;
      resultDiv.innerHTML = `
        <h3>${videoData.title}</h3>
        <div class="audio-controls">
          <a href="${mp3Data.url}" download="${mp3Data.title || 'audioTikTok'}.mp3"><button>Unduh Audio</button></a>
          <audio controls src="${mp3Data.url}"></audio>
        </div>
        <video controls src="${videoData.no_wm}"></video>
        <div class="download-buttons">
          <a href="${videoData.no_wm}" download="videoTikTok.mp4"><button>Unduh Video</button></a>
          <a href="${videoData.no_wm_hd}" download="videoTikTokHD.mp4"><button>Unduh Video HD</button></a>
        </div>
      `;
      return;
    }

    resultDiv.innerHTML = "Konten tidak ditemukan atau API tidak mendukung link ini.";

  } catch (err) {
    console.error(err);
    resultDiv.innerHTML = "Terjadi error saat memproses";
  }
}
</script>
</body>
</html>