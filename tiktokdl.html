<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Infinix TikTok Downloader - Village Theme</title>
<style>
body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    background: url('https://qu.ax/vneoG.jpg') no-repeat center center fixed;
    background-size: cover;
    color: #fff;
    overflow-x: hidden;
}
body::before {
    content:'';
    position:fixed;
    top:0; left:0; right:0; bottom:0;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    background: rgba(0,0,0,0.4);
    z-index:-1;
}
.header {
    position: fixed;
    top: 10px;
    left: 10px;
    z-index: 100;
    display: flex;
    gap: 10px;
}
.header button {
    padding: 8px 12px;
    border-radius: 8px;
    border: none;
    background: #00AEEF;
    color: #fff;
    cursor: pointer;
}
.header button:hover { background: #008CBA; }
.container {
    max-width: 700px;
    margin: 100px auto 50px auto;
    padding: 25px;
    text-align: center;
}
h2 { color:#00AEEF; margin-bottom:20px; }
input[type=text] {
    width: 100%;
    padding:12px;
    border-radius:8px;
    border:none;
    margin-bottom:15px;
    font-size:1em;
}
button#downloadBtn {
    padding:10px 15px;
    border:none;
    border-radius:8px;
    background:#00AEEF;
    color:#fff;
    cursor:pointer;
    margin:5px;
}
button#downloadBtn:hover { background:#008CBA; }
.result { margin-top:25px; display:none; }
video { width:100%; border-radius:12px; margin:10px 0; }
.download-links { margin-top:20px; }
.download-links a {
    display:inline-block;
    padding:10px 15px;
    border-radius:8px;
    background:#00AEEF;
    color:#fff;
    text-decoration:none;
    margin:5px;
}
.download-links a:hover { background:#008CBA; }
.loading { display:none; color:#00AEEF; margin-top:10px; }
</style>
</head>
<body>

<div class="header">
    <button onclick="window.location.href='tiktokdl.html'">TikTok Download</button>
    <button onclick="window.location.href='ytdl.html'">YouTube Download</button>
    <button onclick="window.location.href='index.html'">Dashboard</button>
</div>

<div class="container">
<h2>üéµ TikTok Downloader</h2>
<input type="text" id="tiktokUrl" placeholder="Masukkan link TikTok...">
<button id="downloadBtn">Download</button>
<div class="loading" id="loading">Sedang mengambil data...</div>

<div class="result" id="result">
    <video id="videoPlayer" controls></video>
    <div class="download-links" id="downloads"></div>
</div>
</div>

<script>
document.getElementById('downloadBtn').addEventListener('click', async ()=>{
    const url = document.getElementById('tiktokUrl').value.trim();
    if(!url) return alert('Masukkan URL TikTok dulu üòé');

    const resultDiv = document.getElementById('result');
    const videoPlayer = document.getElementById('videoPlayer');
    const downloadsDiv = document.getElementById('downloads');
    const loading = document.getElementById('loading');

    // Reset tampilan
    resultDiv.style.display='none';
    videoPlayer.src='';
    downloadsDiv.innerHTML='';
    loading.style.display='block';

    try{
        // Ambil video
        const apiVideo = `https://api.siputzx.my.id/api/d/tiktok?url=${encodeURIComponent(url)}`;
        const resVideo = await fetch(apiVideo);
        const dataVideo = await resVideo.json();

        if(!dataVideo.status) throw new Error('Gagal mengambil video.');

        const videoUrl = dataVideo.data.urls[0];
        videoPlayer.src = videoUrl;
        resultDiv.style.display='block';

        // Tombol download Video
        const videoLink = document.createElement('a');
        videoLink.href = videoUrl;
        videoLink.textContent = '‚¨áÔ∏è Download Video';
        videoLink.target = '_blank';
        downloadsDiv.appendChild(videoLink);

        // Ambil MP3 dari API Vreden
        const apiMp3 = `https://api.vreden.my.id/api/v1/download/tiktok?url=${encodeURIComponent(url)}`;
        const resMp3 = await fetch(apiMp3);
        const dataMp3 = await resMp3.json();

        if(dataMp3?.result?.music_info?.url){
            const mp3Link = document.createElement('a');
            mp3Link.href = dataMp3.result.music_info.url;
            mp3Link.textContent='üéµ Download MP3';
            mp3Link.target='_blank';
            downloadsDiv.appendChild(mp3Link);
        }

        loading.style.display='none';
    }catch(err){
        loading.style.display='none';
        alert('Terjadi kesalahan: ' + err.message);
    }
});
</script>
</body>
</html>